IN SQLQUERIES.CS

public string InvertedEmployeesSQL()
        {
            return "SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxProfSal " +
                    "FROM MAIN as t1 " +
                    "INNER JOIN " +

                    "(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxProfSal " +
                    "FROM MAIN " +
                    "WHERE RNK = 'Prof' " +
                    "GROUP BY DEPT, RNK) AS t2 " +
                    "ON t1.DEPT = t2.DEPT " +
                    "WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] > t2.MaxProfSal) " +
                    "OR  (t1.RNK = 'Asst' AND t1.[9MSALARY] > t2.MaxProfSal) " +
                    "OR  (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxProfSal) " +
                    "GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxProfSal " +

                    "UNION " +

                    "SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxAssoSal " +
                    "FROM MAIN as t1 " +
                    "INNER JOIN " +

                    "(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxAssoSal " +
                    "FROM MAIN " +
                    "WHERE RNK = 'Asso' " +
                    "GROUP BY DEPT, RNK) AS t2 " +
                    "ON t1.DEPT = t2.DEPT " +
                    "WHERE (t1.RNK = 'Asst' AND t1.[9MSALARY] > t2.MaxAssoSal) " +
                    "OR  (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxAssoSal) " +
                    "OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxAssoSal) " +
                    "GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxAssoSal " +

                    "UNION " +

                    "SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxAsstSal " +
                    "FROM MAIN as t1 " +
                    "INNER JOIN " +

                    "(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxAsstSal " +
                    "FROM MAIN " +
                    "WHERE RNK = 'Asst' " +
                    "GROUP BY DEPT, RNK) AS t2 " +
                    "ON t1.DEPT = t2.DEPT " +
                    "WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.MaxAsstSal) " +
                    "OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxAsstSal) " +
                    "OR (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxAsstSal) " +
                    "GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxAsstSal " +

                    "UNION " +

                    "SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxInstrSal " +
                    "FROM MAIN as t1 " +
                    "INNER JOIN " +

                    "(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxInstrSal " +
                    "FROM MAIN " +
                    "WHERE RNK = 'Instr' " +
                    "GROUP BY DEPT, RNK) AS t2 " +
                    "ON t1.DEPT = t2.DEPT " +
                    "WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.MaxInstrSal) " +
                    "OR  (t1.RNK = 'Asst' AND t1.[9MSALARY] < t2.MaxInstrSal) " +
                    "OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxInstrSal) " +
                    "GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxInstrSal";
        }

IN MAINWINDOW.XAML.CS
private void BtnReport4_Click(object sender, RoutedEventArgs e)
        {
            DataSet reportData = dataProcessor.InvertedEmployees();
            dgReport.ItemsSource = null;
            dgReport.ItemsSource = reportData.Tables[0].AsDataView();
            dgReport.Visibility = Visibility.Visible;
            HighlightSelectedReport(4);
        }

IN PROCESS.CS
        public DataSet InvertedEmployees()
        {
            int returnedRows = 0;
            return db.ExecuteSQLStatement(query.InvertedEmployeesSQL(), ref returnedRows);
        }

ACCESS SQL
SELECT t1.DEPT AS DEPT, t1.Name AS Name, t1.RNK AS RNK, t1.[9MSALARY] AS Salary, MaxProfSal, MaxAssoSal, MaxAsstSal, MaxInstrSal
FROM MAIN as t1

INNER JOIN

(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxProfSal,  0 AS MaxAssoSal, 0 AS MaxAsstSal, 0 AS MaxInstrSal
FROM MAIN
WHERE RNK = 'Prof'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] > t2.MaxProfSal)
OR  (t1.RNK = 'Asst' AND t1.[9MSALARY] > t2.MaxProfSal)
OR  (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxProfSal)
GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxProfSal, MaxAssoSal, MaxAsstSal, MaxInstrSal

UNION

SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxAssoSal , 0 AS MaxProfSal, 0 AS MaxAsstSal, 0 AS MaxInstrSal
FROM MAIN as t1
INNER JOIN

(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxAssoSal
FROM MAIN
WHERE RNK = 'Asso'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE (t1.RNK = 'Asst' AND t1.[9MSALARY] > t2.MaxAssoSal)
OR  (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxAssoSal)
OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxAssoSal)
GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxProfSal, MaxAssoSal, MaxAsstSal, MaxInstrSal

UNION

SELECT t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxAsstSal, 0 AS MaxProfSal, 0 AS MaxAssoSal, 0 AS MaxInstrSal
FROM MAIN as t1
INNER JOIN

(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxAsstSal
FROM MAIN
WHERE RNK = 'Asst'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.MaxAsstSal)
OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxAsstSal)
OR (t1.RNK = 'Instr' AND t1.[9MSALARY] > t2.MaxAsstSal)
GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxProfSal, MaxAssoSal, MaxAsstSal, MaxInstrSal

UNION

SELECT  t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY] AS Salary, MaxInstrSal, 0 AS MaxProfSal, 0 AS MaxAsstSal, 0 AS MaxAssoSal
FROM MAIN as t1
INNER JOIN

(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS MaxInstrSal
FROM MAIN
WHERE RNK = 'Instr'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE (t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.MaxInstrSal)
OR  (t1.RNK = 'Asst' AND t1.[9MSALARY] < t2.MaxInstrSal)
OR  (t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.MaxInstrSal)
GROUP BY t1.DEPT, t1.Name, t1.RNK, t1.[9MSALARY], MaxProfSal, MaxAssoSal, MaxAsstSal, MaxInstrSal

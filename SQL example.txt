SELECT tb1.DEPT, tb1.NAME
FROM

(SELECT t1.DEPT AS DEPT, t1.NAME AS NAME, t2.maxAssoSal - t1.[9MSALARY] AS "Inversion $ Amount" 
FROM MAIN as t1 
INNER JOIN 
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAssoSal 
FROM MAIN 
WHERE RNK = 'Asso' 
GROUP BY DEPT, RNK) AS t2 
ON t1.DEPT = t2.DEPT 
WHERE t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.maxAssoSal) AS tb1

LEFT OUTER JOIN

(SELECT t1.DEPT AS DEPT, t1.NAME AS NAME, t2.maxAsstSal - t1.[9MSALARY] AS "Inversion $ Amount"
FROM MAIN as t1 
INNER JOIN 
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAsstSal 
FROM MAIN 
WHERE RNK = 'Asst' 
GROUP BY DEPT, RNK) AS t2 
ON t1.DEPT = t2.DEPT 
WHERE t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.maxAsstSal) AS tb2

ON tb1.DEPT = tb2.DEPT AND tb1.NAME = tb2.NAME
WHERE tb2.NAME IS NULL;
--Counts of inversion per department

--FULL PROFESSOR

--Full Professor Compared to Instructor

SELECT t1.DEPT, count(*) as "FP to Instr Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxInstrSal
FROM MAIN
WHERE RNK = 'Instr'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.maxInstrSal
GROUP BY t1.DEPT;


--Full Professor to Asst

SELECT t1.DEPT, count(*) as "FP to Asst Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAsstSal
FROM MAIN
WHERE RNK = 'Asst'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.maxAsstSal
GROUP BY t1.DEPT;

--Full Professor to Asso

SELECT t1.DEPT, count(*) as "FP to Asso Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAssoSal
FROM MAIN
WHERE RNK = 'Asso'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Prof' AND t1.[9MSALARY] < t2.maxAssoSal
GROUP BY t1.DEPT;


--ASSO PROFESSOR

--Asso Professor Compared to Instructor

SELECT t1.DEPT, count(*) as "Asso to Instr Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAssoSal
FROM MAIN
WHERE RNK = 'Instr'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.maxAssoSal
GROUP BY t1.DEPT;

--Asso Professor to Asst

SELECT t1.DEPT, count(*) as "Asso to Asst Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxAsstSal
FROM MAIN
WHERE RNK = 'Asst'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Asso' AND t1.[9MSALARY] < t2.maxAsstSal
GROUP BY t1.DEPT;

--ASST PROFESSOR

--Asst Professor Compared to Instructor

SELECT t1.DEPT, count(*) as "Asst to Instr Inv"
FROM MAIN as t1
INNER JOIN
(SELECT DEPT, RNK, MAX(MAIN.[9MSALARY]) AS maxInstrSal
FROM MAIN
WHERE RNK = 'Instr'
GROUP BY DEPT, RNK) AS t2
ON t1.DEPT = t2.DEPT
WHERE t1.RNK = 'Asst' AND t1.[9MSALARY] < t2.maxInstrSal
GROUP BY t1.DEPT;
